syms i;
j = 1i;

R = 2; Zl = 3*j; Zc = (-2)*j; Ig = 5; Vg = -2*j; r = 2; 

Z11 = 3; Z12 = 1/3; Z21 = -1; Z22 = 2;

A = [0 R 0 0 0 -1 1;
    0 0 0 1 1 1 0;
    (Zl + (Zc/2)) 0 (-Zc/2) 1 0 0 1;
    (-Zc/2) 0 (Zc + (Zc/2) + R) 0 0 0 0;
    0 -r 0 1 0 0 0;
    -Z12 (Z11-Z12) 0 0 0 1 0;
    -Z22 (Z21-Z22) 0 0 0 0 1];

b = [0; (-Zc*Ig) ; 0 ; -Vg ; 0 ; Z11*Ig; Z21*Ig ];

x = inv(A)*b;
disp('I1 = ')
disp(x(1));

disp('IR = ')
disp(x(2));

Iz2 = x(1) + x(2)
